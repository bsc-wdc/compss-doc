\section{COMPSs Modules}
\label{sec:Modules}


\subsection{Available modules}
COMPSs is configured in MareNostrum (MN3) as a Linux Module. Type \textit{module available COMPSs} to list the available COMPSs modules 
through Linux Module configuration and \textit{module load $COMPSs/<version>$} to load it.
\begin{lstlisting}[language=bash]
$ module available COMPSs
---------- /apps/modules/modulefiles/tools ----------
COMPSs/1.1.2_gpfs
COMPSs/1.1.2_scratch
COMPSs/1.2
COMPSs/1.3
COMPSs/1.4
COMPSs/2.0

COMPSs/release(default)
COMPSs/trunk


$ module load COMPSs/release
load java/1.8.0u66 (PATH, MANPATH, JAVA_HOME, JAVA_ROOT, JAVA_BINDIR,
                    SDK_HOME, JDK_HOME, JRE_HOME)
load MKL/11.0.1 (LD_LIBRARY_PATH)
load PYTHON/2.7.3 (PATH, MANPATH, LD_LIBRARY_PATH, C_INCLUDE_PATH)
load COMPSs/release (PATH, MANPATH, IT_HOME)
\end{lstlisting}

The following command can be run to check if the correct COMPSs version has been loaded:
\begin{lstlisting}[language=bash]
$ runcompss --version
COMPSs version <version>

\end{lstlisting}

\subsection{Configuration}
The COMPSs module contains \textbf{all} the COMPSs dependencies, including Java, Python and MKL. Modifying any of these dependencies
can cause execution failures and thus, we \textbf{do not} recomend to change them. Before running any COMPSs job please check your 
environment and, if needed, comment out any line inside the \textit{.bashrc} file loading custom COMPSs, Java, Python and/or MKL
modules.

The COMPSs module needs to be loaded in all the nodes that will run COMPSs jobs. Consequently, the \textit{module load} \textbf{must}
be included in your \textit{.bashrc} file. To do so, please run the following command with the corresponding COMPSs version:
\begin{lstlisting}[language=bash]
$ cat "module load COMPSs/release" >> ~/.bashrc
\end{lstlisting}

Log out and back in again to check that the file has been correctly edited. The next listing shows an example of the
output generated by well loaded COMPSs installation. 
\begin{lstlisting}[language=bash]
$ exit
$ ssh USER@mn1.bsc.es
load java/1.8.0u66 (PATH, MANPATH, JAVA_HOME, JAVA_ROOT, JAVA_BINDIR,
                    SDK_HOME, JDK_HOME, JRE_HOME)
load MKL/11.0.1 (LD_LIBRARY_PATH)
load PYTHON/2.7.3 (PATH, MANPATH, LD_LIBRARY_PATH, C_INCLUDE_PATH)
load COMPSs/release (PATH, MANPATH, IT_HOME)

$ runcompss --version
COMPSs version <version>
\end{lstlisting}

\colorComment{Please remember that COMPSs runs in several nodes and your current enviroment is not exported to them. Thus, all the 
needed environment variables \textbf{must} be loaded through the \textit{.bashrc} file.}

